http://0.0.0.0:80/
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558706</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/Score?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>详细成绩</a>]]></Content>
				</xml>
True
True
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558752</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[您已绑定,您的绑定信息为
用户名：107242017000646
密  码：107242017000646]]></Content>
				</xml>
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558760</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/Score?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>详细成绩</a>]]></Content>
				</xml>
True
True
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558782</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/Score?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>详细成绩</a>]]></Content>
				</xml>
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558794</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[解绑成功]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558797</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558800</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[解绑成功]]></Content>
				</xml>
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558804</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[解绑成功]]></Content>
				</xml>
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558808</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/Score?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>详细成绩</a>]]></Content>
				</xml>
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558817</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/Score?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>详细成绩</a>]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558818</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
True
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558822</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[您已绑定,您的绑定信息为
用户名：107242017000646
密  码：107242017000646]]></Content>
				</xml>
True
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558829</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[您已绑定,您的绑定信息为
用户名：107242017000646
密  码：107242017000646]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558831</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558832</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558833</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558834</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558838</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[解绑失败，您未绑定]]></Content>
				</xml>
True
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558839</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[您已绑定,您的绑定信息为
用户名：107242017000646
密  码：107242017000646]]></Content>
				</xml>
True
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558841</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[您已绑定,您的绑定信息为
用户名：107242017000646
密  码：107242017000646]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558989</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
<Storage {'openid': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}>
False
False
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535558999</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
False
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535559111</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[<a href='http://xiwai.chdbwtx.cn/binding?openid=oErKPvxKm3-DvHFPjrV-Y67aXsj8'>绑定</a>]]></Content>
				</xml>
True
True
	<xml>
				<ToUserName><![CDATA[oErKPvxKm3-DvHFPjrV-Y67aXsj8]]></ToUserName>
				<FromUserName><![CDATA[gh_0a65c4703470]]></FromUserName>
				<CreateTime>1535559115</CreateTime>
				<MsgType><![CDATA[text]]></MsgType>
				<Content><![CDATA[您已绑定,您的绑定信息为
用户名：107242017000646
密  码：107242017000646]]></Content>
				</xml>140.207.54.76:16230 - - [30/Aug/2018 00:05:06] "HTTP/1.1 POST /wx" - 200 OK
61.129.8.199:44913 - - [30/Aug/2018 00:05:17] "HTTP/1.1 GET /Score" - 200 OK
223.104.11.25:3891 - - [30/Aug/2018 00:05:17] "HTTP/1.1 GET /favicon.ico" - 404 Not Found
140.207.54.76:40784 - - [30/Aug/2018 00:05:52] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:56757 - - [30/Aug/2018 00:06:00] "HTTP/1.1 POST /wx" - 200 OK
61.129.8.199:37849 - - [30/Aug/2018 00:06:09] "HTTP/1.1 GET /Score" - 200 OK
223.104.11.25:3892 - - [30/Aug/2018 00:06:09] "HTTP/1.1 GET /favicon.ico" - 404 Not Found
58.247.212.98:40203 - - [30/Aug/2018 00:06:16] "HTTP/1.1 GET /Score" - 200 OK
223.104.11.25:3892 - - [30/Aug/2018 00:06:17] "HTTP/1.1 GET /favicon.ico" - 404 Not Found
140.207.54.75:32738 - - [30/Aug/2018 00:06:22] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:55591 - - [30/Aug/2018 00:06:34] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.76:60074 - - [30/Aug/2018 00:06:37] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:2423 - - [30/Aug/2018 00:06:40] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:9718 - - [30/Aug/2018 00:06:44] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.76:16138 - - [30/Aug/2018 00:06:48] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:32254 - - [30/Aug/2018 00:06:57] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:35877 - - [30/Aug/2018 00:06:58] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.76:42642 - - [30/Aug/2018 00:07:02] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:55467 - - [30/Aug/2018 00:07:09] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:58896 - - [30/Aug/2018 00:07:11] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:61035 - - [30/Aug/2018 00:07:12] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:63316 - - [30/Aug/2018 00:07:13] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.76:65064 - - [30/Aug/2018 00:07:14] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.76:7908 - - [30/Aug/2018 00:07:18] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:10346 - - [30/Aug/2018 00:07:19] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:13212 - - [30/Aug/2018 00:07:21] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:26643 - - [30/Aug/2018 00:09:49] "HTTP/1.1 POST /wx" - 200 OK
61.129.8.199:64475 - - [30/Aug/2018 00:09:54] "HTTP/1.1 GET /binding" - 200 OK
223.104.11.25:3893 - - [30/Aug/2018 00:09:54] "HTTP/1.1 GET /favicon.ico" - 404 Not Found
61.129.8.199:42900 - - [30/Aug/2018 00:09:55] "HTTP/1.1 POST /postBindData" - 200 OK
61.129.8.199:43825 - - [30/Aug/2018 00:09:55] "HTTP/1.1 POST /postBindData" - 200 OK
140.207.54.75:43139 - - [30/Aug/2018 00:09:59] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:54970 - - [30/Aug/2018 00:11:51] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.75:61352 - - [30/Aug/2018 00:11:55] "HTTP/1.1 POST /wx" - 200 OK
140.207.54.76:6066 - - [30/Aug/2018 00:12:00] "HTTP/1.1 POST /wx" - 200 OK
27.32.247.112:44533 - - [30/Aug/2018 00:18:34] "HTTP/1.1 GET /" - 404 Not Found
109.235.58.226:40910 - - [30/Aug/2018 00:21:17] "HTTP/1.1 GET /" - 404 Not Found
187.122.189.163:36211 - - [30/Aug/2018 00:27:04] "HTTP/1.1 GET /" - 404 Not Found
91.236.179.146:39537 - - [30/Aug/2018 00:48:03] "HTTP/1.1 GET /" - 404 Not Found
103.46.239.82:56400 - - [30/Aug/2018 01:27:13] "HTTP/1.1 GET /" - 404 Not Found
125.164.52.17:34906 - - [30/Aug/2018 01:42:12] "HTTP/1.1 GET /" - 404 Not Found
80.82.70.187:43760 - - [30/Aug/2018 02:14:38] "HTTP/1.1 GET /cache/global/img/gs.gif" - 404 Not Found
95.12.164.204:33285 - - [30/Aug/2018 03:06:42] "HTTP/1.1 GET /" - 404 Not Found
139.162.88.63:57524 - - [30/Aug/2018 03:14:39] "HTTP/1.1 GET /echo.php" - 404 Not Found
101.200.121.9:3931 - - [30/Aug/2018 05:13:31] "HTTP/1.1 GET /" - 404 Not Found
189.194.235.22:43705 - - [30/Aug/2018 05:53:15] "HTTP/1.1 GET /" - 404 Not Found
59.36.132.144:42983 - - [30/Aug/2018 07:32:39] "HTTP/1.1 OPTION /" - 404 Not Found
59.36.132.144:43033 - - [30/Aug/2018 07:32:39] "HTTP/1.1 GET /" - 404 Not Found
188.18.201.128:48608 - - [30/Aug/2018 07:43:23] "HTTP/1.1 GET /login.cgi" - 404 Not Found
45.77.242.206:56246 - - [30/Aug/2018 08:46:11] "HTTP/1.1 GET /" - 404 Not Found
31.3.88.166:37931 - - [30/Aug/2018 08:53:35] "HTTP/1.1 GET /" - 404 Not Found
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 103, in contentRecv
    data = self.bangding()
  File "/var/www/html/web/wechat/type.py", line 125, in bangding
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 103, in contentRecv
    data = self.bangding()
  File "/var/www/html/web/wechat/type.py", line 125, in bangding
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 103, in contentRecv
    data = self.bangding()
  File "/var/www/html/web/wechat/type.py", line 125, in bangding
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 103, in contentRecv
    data = self.bangding()
  File "/var/www/html/web/wechat/type.py", line 125, in bangding
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 103, in contentRecv
    data = self.bangding()
  File "/var/www/html/web/wechat/type.py", line 125, in bangding
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

TypeError('write() argument must be str, not bytes',)
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 103, in contentRecv
    data = self.bangding()
  File "/var/www/html/web/wechat/type.py", line 125, in bangding
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1089, in communicate
    req.respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 877, in respond
    self.server.gateway(self).respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1980, in respond
    response = self.req.server.wsgi_app(self.env, self.start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 324, in __call__
    return self.app(environ, xstart_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 294, in __call__
    return self.app(environ, start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 295, in wsgi
    result = self.handle_with_processors()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 267, in handle_with_processors
    return process(self.processors)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes
TypeError('write() argument must be str, not bytes',)
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1089, in communicate
    req.respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 877, in respond
    self.server.gateway(self).respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1980, in respond
    response = self.req.server.wsgi_app(self.env, self.start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 324, in __call__
    return self.app(environ, xstart_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 294, in __call__
    return self.app(environ, start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 295, in wsgi
    result = self.handle_with_processors()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 267, in handle_with_processors
    return process(self.processors)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes
TypeError('write() argument must be str, not bytes',)
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1089, in communicate
    req.respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 877, in respond
    self.server.gateway(self).respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1980, in respond
    response = self.req.server.wsgi_app(self.env, self.start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 324, in __call__
    return self.app(environ, xstart_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 294, in __call__
    return self.app(environ, start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 295, in wsgi
    result = self.handle_with_processors()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 267, in handle_with_processors
    return process(self.processors)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

TypeError('write() argument must be str, not bytes',)
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1089, in communicate
    req.respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 877, in respond
    self.server.gateway(self).respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1980, in respond
    response = self.req.server.wsgi_app(self.env, self.start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 324, in __call__
    return self.app(environ, xstart_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 294, in __call__
    return self.app(environ, start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 295, in wsgi
    result = self.handle_with_processors()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 267, in handle_with_processors
    return process(self.processors)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

TypeError('write() argument must be str, not bytes',)
Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 257, in process
    return self.handle()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 248, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 488, in _delegate
    return handle_class(cls)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 466, in handle_class
    return tocall(*args)
  File "/var/www/html/web/wechat/weixin.py", line 53, in POST
    content =  mywechat.choose()
  File "/var/www/html/web/wechat/type.py", line 58, in choose
    content = self.contentRecv(data)
  File "/var/www/html/web/wechat/type.py", line 100, in contentRecv
    data =  self.chengji()
  File "/var/www/html/web/wechat/type.py", line 141, in chengji
    flag=user.selectUserFlag(fromUser)
  File "/var/www/html/web/dao/userDao.py", line 23, in selectUserFlag
    user = self.session.query(User).filter_by(openid=opendiStr).one()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2947, in one
    ret = self.one_or_none()
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2917, in one_or_none
    ret = list(self)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2988, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3011, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 265, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 248, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/python3/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 509, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 516, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 727, in _read_query_result
    result.read()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 1066, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 656, in _read_packet
    packet_header = self._read_bytes(4)
  File "/usr/local/python3/lib/python3.6/site-packages/pymysql/connections.py", line 702, in _read_bytes
    CR.CR_SERVER_LOST, "Lost connection to MySQL server during query")
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query') [SQL: 'SELECT user.openid AS user_openid, user.username AS user_username, user.password AS user_password, user.flag AS user_flag \nFROM user \nWHERE user.openid = %(openid_1)s'] [parameters: {'openid_1': 'oErKPvxKm3-DvHFPjrV-Y67aXsj8'}] (Background on this error at: http://sqlalche.me/e/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 658, in processor
    result = handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in process
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 643, in processor
    return handler()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 255, in <lambda>
    return p(lambda: process(processors))
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1089, in communicate
    req.respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 877, in respond
    self.server.gateway(self).respond()
  File "/usr/local/python3/lib/python3.6/site-packages/web/wsgiserver/wsgiserver3.py", line 1980, in respond
    response = self.req.server.wsgi_app(self.env, self.start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 324, in __call__
    return self.app(environ, xstart_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/httpserver.py", line 294, in __call__
    return self.app(environ, start_response)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 295, in wsgi
    result = self.handle_with_processors()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 267, in handle_with_processors
    return process(self.processors)
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 264, in process
    raise self.internalerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/application.py", line 545, in internalerror
    return debugerror()
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 313, in debugerror
    return web._InternalError(djangoerror())
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 303, in djangoerror
    return t(exception_type, exception_value, frames)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 904, in __call__
    return BaseTemplate.__call__(self, *a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/template.py", line 831, in __call__
    return self.t(*a, **kw)
  File "/usr/local/python3/lib/python3.6/site-packages/web/debugerror.py", line 193, in __template__
    </div>
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 364, in input
    out = rawinput(_method)
  File "/usr/local/python3/lib/python3.6/site-packages/web/webapi.py", line 341, in rawinput
    a = cgi.FieldStorage(fp=fp, environ=e, keep_blank_values=1)
  File "/usr/local/python3/lib/python3.6/cgi.py", line 561, in __init__
    self.read_single()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 740, in read_single
    self.read_binary()
  File "/usr/local/python3/lib/python3.6/cgi.py", line 762, in read_binary
    self.file.write(data)
TypeError: write() argument must be str, not bytes
